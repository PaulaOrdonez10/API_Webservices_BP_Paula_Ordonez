<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>API_Weather_Paula_Ordonez</bpr:name>
    <bpr:release-notes />
    <bpr:created>2024-05-03 14:40:30Z</bpr:created>
    <bpr:package-id>22</bpr:package-id>
    <bpr:package-name>API_Weather_Paula_Ordonez</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="11">
        <process id="3cb4dc9e-7fea-47f3-8536-2c54fa266335" name="API_Weather_Paula_Ordonez - Process" xmlns="http://www.blueprism.co.uk/product/process"><process name="API_Weather_Paula_Ordonez - Process" version="1.0" bpversion="7.2.1.7446" narrative="" byrefcollection="true" processrunningmessage="" disableversioning="false"><view><camerax>265</camerax><cameray>505</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="e140da8b-6041-4184-b819-a7f27ebb730f" type="Normal" published="False"><name>Initialization</name><view><camerax>0</camerax><cameray>27</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a074a96f-75b8-4a58-9db9-b5f33cb1355d" type="Normal" published="False"><name>Input Validation</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="179011dc-6858-46c0-a4ca-bb59e3bce272" type="Normal" published="False"><name>Load Queue</name><view><camerax>107</camerax><cameray>63</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="a203acf2-4a8d-4249-bc98-0ff7ef117e52" type="Normal" published="False"><name>Search With API</name><view><camerax>22</camerax><cameray>-99</cameray><zoom version="2">1.5625</zoom></view></subsheet><subsheet subsheetid="cd9e6bbd-aec8-4903-8dcc-3c61212b36ea" type="Normal" published="False"><name>Send Mail</name><view><camerax>-13</camerax><cameray>102</cameray><zoom version="2">2.1875</zoom></view></subsheet><subsheet subsheetid="dc85990b-873b-41f5-a890-4235c82a6945" type="Normal" published="False"><name>Mark Item As Exception</name><view><camerax>90</camerax><cameray>120</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5a450492-3646-4305-b66c-24f04a043fdc" type="Normal" published="False"><name>Write to Log File</name><view><camerax>90</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="17f50615-0daf-4f08-b6b0-93027451ea25" type="Normal" published="False"><name>Reset Global Data</name><view><camerax>90</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bf8c38d5-ec20-41f8-ba86-08f891a34c27" type="Normal" published="False"><name>Mark Item As Completed</name><view><camerax>90</camerax><cameray>-117</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bbfd9f07-994b-4939-8c7b-4c87152e4356" type="Normal" published="False"><name>Write Results &amp; Send Email</name><view><camerax>44</camerax><cameray>75</cameray><zoom version="2">1.5625</zoom></view></subsheet><stage stageid="ccbdccf8-5d26-4704-bb30-9bd9dcd84bcc" name="Start" type="Start"><display x="75" y="-105" /><onsuccess>89b58eb7-c265-453e-b176-c1c0bfd4588b</onsuccess></stage><stage stageid="6d55daa9-2571-4345-a1b7-b45255dc8e6d" name="End" type="End"><display x="225" y="165" /></stage><stage stageid="9eba9e18-4736-4b6c-9077-989af573bc20" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="f5940282-8d47-4dfb-a82d-320f0b87c890" name="Item ID" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="375" w="210" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="00167acf-4758-4a5f-b6af-eada3d608088" name="Item Status" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="405" w="210" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="a7bd8911-ee8b-45f7-8efd-eeaeb3d7699e" name="Item Attempts" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="435" w="210" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><alwaysinit /></stage><stage stageid="193ef5c8-eff8-488f-b0d1-2bb0aa92b359" name="Item Data" type="Block"><loginhibit onsuccess="true" /><display x="-315" y="285" w="210" h="180" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="f22c7d2d-4899-4097-9d33-d093e34438a5" name="Item Data" type="Collection"><loginhibit onsuccess="true" /><display x="-210" y="330" w="210" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /><collectioninfo><field name="City" type="text" /><field name="Email" type="text" /><field name="Country" type="text" /></collectioninfo><initialvalue><row><field name="City" type="text" value="" /><field name="Email" type="text" value="" /><field name="Country" type="text" value="" /></row></initialvalue></stage><stage stageid="0cb60b55-80fb-42f0-8ad6-9171d78ba017" name="Process Settings" type="Block"><loginhibit onsuccess="true" /><display x="-315" y="-30" w="210" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="09b5956b-e123-422c-b126-925ca382a269" name="Queue Name" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="0" w="210" h="30" /><font family="Tahoma" size="10" style="Bold" color="0000FF" /><datatype>text</datatype><initialvalue xml:space="preserve">API_Weather_Paula_Ordonez - Queue</initialvalue><alwaysinit /></stage><stage stageid="3f51881d-b7cd-48cb-a80b-42ff9c17aef4" name="Mark Item As Exception" type="SubSheetInfo"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the current work queue item as an exception</narrative><display x="-120" y="-225" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="84b71a9f-5c01-418d-986f-cfa877e77e01" name="Start" type="Start"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>596a04df-2b1e-4e3a-9cf6-9a4c0d3638bf</onsuccess></stage><stage stageid="be214b81-7b3e-45d6-b3e2-a85b876f2ebb" name="Retry Exception?" type="Decision"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system exception&quot; OR Lower([Exception Type])=&quot;internal&quot;" /><ontrue>67131bcd-6f9a-4343-aa9c-75425dceb027</ontrue><onfalse>0cf8a27e-61e3-4077-a8e3-71b2a51f84f3</onfalse></stage><stage stageid="60396cd9-0b37-419b-adee-2ff0f4bfdd89" name="Previous Exception?" type="Decision"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Previous Exception Detail]=[Exception Detail]" /><ontrue>0115133e-8f76-481e-ad9e-420de43d34ab</ontrue><onfalse>f40fbe31-24d3-4355-bce2-b6ad72d98a9f</onfalse></stage><stage stageid="e522b89f-1916-45f5-ad3f-c509104f88a5" name="Previous Exception Detail" type="Data"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="-150" y="165" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="0115133e-8f76-481e-ad9e-420de43d34ab" name="Count" type="Calculation"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>07644915-c843-49d2-9116-f0d0be24be36</onsuccess><calculation expression="1+ [Consecutive Exception Count]" stage="Consecutive Exception Count" /></stage><stage stageid="b30e497f-6bed-4a3a-80b6-505f23014df7" name="Consecutive Exception Count" type="Data"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="-150" y="210" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue></stage><stage stageid="07644915-c843-49d2-9116-f0d0be24be36" name="Limit?" type="Decision"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="375" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Consecutive Exception Count]&gt;=[Consecutive Exception Limit]" /><ontrue>d3abfa12-8822-43a1-9280-42c8c6f31d50</ontrue><onfalse>b89f3ada-ce10-403c-be5a-12f580e4f25d</onfalse></stage><stage stageid="d3abfa12-8822-43a1-9280-42c8c6f31d50" name="TERMINATE" type="Exception"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="480" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="10fc328a-02ed-4e44-b6d4-5a7e41f65bd8" name="Consecutive Exception Limit" type="Data"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="-150" y="255" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="b89f3ada-ce10-403c-be5a-12f580e4f25d" name="End2" type="End"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="180" y="375" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f40fbe31-24d3-4355-bce2-b6ad72d98a9f" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="180" y="225" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>b89f3ada-ce10-403c-be5a-12f580e4f25d</onsuccess><steps><calculation expression="[Exception Detail]" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="7a0e4b43-b443-44f9-adb3-55cab726c680" name="New Item ID" type="Data"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="-150" y="120" w="150" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0cf8a27e-61e3-4077-a8e3-71b2a51f84f3" name="Set Tag Business Exception" type="Action"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Adds a tag to a work queue item</narrative><display x="135" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Business Exception&quot;" /></inputs><onsuccess>1aee43dd-49f5-4914-b053-e737d4cf4869</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="cb97f816-69ed-4153-a8de-3e59cbd78622" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="375" y="30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>2ccf5c9d-8c91-4777-8eed-2fd720539ee0</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="4ebd12a3-bb4a-4a32-a743-f44d3065b651" name="Mark Exception" type="Action"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="True" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>60396cd9-0b37-419b-adee-2ff0f4bfdd89</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="1aee43dd-49f5-4914-b053-e737d4cf4869" name="Mark Exception" type="Action"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="255" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /><input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Detail]" /><input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" /><input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" /></inputs><outputs><output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" /></outputs><onsuccess>cb97f816-69ed-4153-a8de-3e59cbd78622</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" /></stage><stage stageid="2ccf5c9d-8c91-4777-8eed-2fd720539ee0" name="End1" type="End"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="510" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="596a04df-2b1e-4e3a-9cf6-9a4c0d3638bf" name="System Unavailable?" type="Decision"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-60" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Lower([Exception Type])=&quot;system unavailable exception&quot; OR Lower([Exception Type])=&quot;login system exception&quot;" /><ontrue>00473933-7468-4fd7-9c4b-4f5b3177c226</ontrue><onfalse>be214b81-7b3e-45d6-b3e2-a85b876f2ebb</onfalse></stage><stage stageid="00473933-7468-4fd7-9c4b-4f5b3177c226" name="Release Item" type="Action"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Unlocks a currently locked work queue item</narrative><display x="-120" y="-60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the work queue item which should be unlocked" expr="[Item ID]" /></inputs><outputs><output type="flag" name="Unlocked" narrative="Whether the item was unlocked as a result of this action or not. If the item had finished being worked elsewhere before this action had run, this will be 'False'" stage="" /></outputs><onsuccess>7458dc7f-2539-47f9-a9a4-3c44429111d9</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Unlock Item" /></stage><stage stageid="7458dc7f-2539-47f9-a9a4-3c44429111d9" name="TERMINATE" type="Exception"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><display x="-120" y="30" w="120" h="60" /><font family="Tahoma" size="10" style="Bold" color="FF0000" /><exception type="" detail="[Consecutive Exception Limit] &amp; &quot; consecutive incidents of &quot; &amp; [Exception Type] &amp; &quot;: &quot; &amp; [Exception Detail]" /></stage><stage stageid="67131bcd-6f9a-4343-aa9c-75425dceb027" name="Set Tag System Exception" type="Action"><subsheetid>dc85990b-873b-41f5-a890-4235c82a6945</subsheetid><loginhibit onsuccess="true" /><narrative>Adds a tag to a work queue item</narrative><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;System Exception&quot;" /></inputs><onsuccess>4ebd12a3-bb4a-4a32-a743-f44d3065b651</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="b30f0e40-fb9b-4d7d-b631-4638ed82401a" name="Write to Log File" type="SubSheetInfo"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="8b3f17c6-c1a2-4a4f-8a53-ff0389ee6bd9" name="Start" type="Start"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="15" y="-105" /><onsuccess>a53c21ea-e6e4-477b-8e90-8b9312d598e5</onsuccess></stage><stage stageid="d4ad9218-88b2-4f1c-a0c2-2431584fbeca" name="End" type="End"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="15" y="75" /></stage><stage stageid="82d8148f-a74b-41fe-94c2-ec757b8f676e" name="Message" type="Data"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a53c21ea-e6e4-477b-8e90-8b9312d598e5" name="Append to Log File" type="Action"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="15" y="-45" /><inputs><input type="text" name="File Name" narrative="The full path of the text file to append to" expr="[API_Weather_Paula_Ordonez - Files Error Path]" /><input type="text" name="Text" narrative="The text to append to the file" expr="FormatDateTime(Today()&amp;&quot; &quot;&amp;LocalTime(), &quot;dd/MM/yyyy HH:mm:ss&quot;)&amp;&quot; - &quot;&amp;[Exception Type]&amp; &quot; - &quot; &amp;[Exception Detail]" /></inputs><outputs><output type="flag" name="Success" narrative="True if successful" stage="Success" /><output type="text" name="Message" narrative="An error message if unsuccessful" stage="Message" /></outputs><onsuccess>7f36468d-57d0-4bd4-af83-8a0814605a14</onsuccess><resource object="Utility - File Management" action="Append to Text File" /></stage><stage stageid="1a29fc18-b205-4e41-87d5-3a32ff09a045" name="Success" type="Data"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7f36468d-57d0-4bd4-af83-8a0814605a14" name="Succeeded?" type="Decision"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="15" y="15" /><decision expression="[Success]" /><ontrue>d4ad9218-88b2-4f1c-a0c2-2431584fbeca</ontrue><onfalse>1f2e63a6-e108-42f3-a1dc-fc5e9dda299b</onfalse></stage><stage stageid="1f2e63a6-e108-42f3-a1dc-fc5e9dda299b" name="System Exception" type="Exception"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><display x="150" y="15" w="90" h="30" /><exception type="System Exception" detail="&quot;Failed to write out to log file.&quot;" /></stage><stage stageid="631fa588-0507-41d7-9565-ed8108310657" name="Block1" type="Block"><subsheetid>5a450492-3646-4305-b66c-24f04a043fdc</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-45" w="150" h="90" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4e8547ca-159b-443a-b26e-0b6d6bd2b574" name="Reset Global Data" type="SubSheetInfo"><subsheetid>17f50615-0daf-4f08-b6b0-93027451ea25</subsheetid><loginhibit onsuccess="true" /><narrative>This page is only used to reset global data items</narrative><display x="-165" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="aea96e7a-dab9-435b-9bfb-3c5c51dc1838" name="Start" type="Start"><subsheetid>17f50615-0daf-4f08-b6b0-93027451ea25</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8f11526a-a3f6-42ee-a8a8-5a742dffced7</onsuccess></stage><stage stageid="8f11526a-a3f6-42ee-a8a8-5a742dffced7" name="End" type="End"><subsheetid>17f50615-0daf-4f08-b6b0-93027451ea25</subsheetid><loginhibit onsuccess="true" /><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b0a8b8c4-bc6b-4f75-94aa-8f03f22c80c8" name="Exception Detail" type="Data"><subsheetid>17f50615-0daf-4f08-b6b0-93027451ea25</subsheetid><display x="-165" y="15" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="cf7566ed-6585-445f-a277-0829e7b57d51" name="Exception Type" type="Data"><subsheetid>17f50615-0daf-4f08-b6b0-93027451ea25</subsheetid><display x="-165" y="-15" w="150" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="d9c440b2-2c6c-4335-b3e7-6ac909352396" name="Mark Item As Completed" type="SubSheetInfo"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><loginhibit onsuccess="true" /><narrative>Marks the current work queue item as complete</narrative><display x="-135" y="-195" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="64fb3f52-bb4e-443a-8ce9-e819836da0dd" name="Start" type="Start"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>dceeb6a1-43e6-44b7-bac3-228077a97333</onsuccess></stage><stage stageid="99ad13f2-2937-46ba-a27b-7c4b30bb6317" name="Mark Completed" type="Action"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative><display x="15" y="-60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" /></inputs><onsuccess>47ea9c38-2217-4978-9315-62fc84368d07</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" /></stage><stage stageid="47ea9c38-2217-4978-9315-62fc84368d07" name="Reset Consecutive Exception Indicators" type="MultipleCalculation"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><display x="15" y="0" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>dcc48dd0-fb8a-4b51-8ed0-0341ed589447</onsuccess><steps><calculation expression="&quot;&quot;" stage="Previous Exception Detail" /><calculation expression="0" stage="Consecutive Exception Count" /></steps></stage><stage stageid="dcc48dd0-fb8a-4b51-8ed0-0341ed589447" name="End3" type="End"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="dceeb6a1-43e6-44b7-bac3-228077a97333" name="Set Tag" type="Action"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><narrative>Adds a tag to a work queue item</narrative><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" /><input type="text" name="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Completed&quot;" /></inputs><onsuccess>99ad13f2-2937-46ba-a27b-7c4b30bb6317</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" /></stage><stage stageid="0398ea99-a426-4e1f-8973-1914ddd677f2" name="Main Code Block" type="Block"><subsheetid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</subsheetid><display x="-45" y="-135" w="120" h="180" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="14cb9475-fd5c-49dd-9b57-69f86ad4a850" name="Environment Variables" type="Block"><loginhibit onsuccess="true" /><display x="-315" y="45" w="210" h="225" /><font family="Segoe UI" size="10" style="Regular" color="FFCC00" /></stage><stage stageid="e12c5843-af44-416e-9705-aff1b4f3e93b" name="API_Weather_Paula_Ordonez - Input City" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="90" w="210" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="1616313b-aaaa-448e-92c8-af460a30347d" name="API_Weather_Paula_Ordonez - Input Email" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="150" w="210" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="d2545d6c-5f0c-40bd-ad91-46cc62f06004" name="API_Weather_Paula_Ordonez - Files Error Path" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="210" w="210" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="80222e3f-d8b8-4ed5-a497-12e49ed2b12d" name="API_Weather_Paula_Ordonez - Retry Limit" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="180" w="210" h="30" /><datatype>number</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="dc5583ce-f77e-48b2-99ed-8317a72669d7" name="Input Validation" type="SubSheetInfo"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><narrative>Checks any environmental settings the process requires, eg screen resolution, folder access etc (the 'environment' and 'file' utility business objects could be useful here).</narrative><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="af8374c3-2d2d-4ade-871d-40390cadd4f6" name="Start" type="Start"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ca2c0a9c-ec1a-40c1-8b62-6b587d4124a3</onsuccess></stage><stage stageid="c3d6a310-7c96-4e8c-bff3-35673527eb7e" name="End" type="End"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ca2c0a9c-ec1a-40c1-8b62-6b587d4124a3" name="Check City" type="Decision"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="15" y="-30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Trim([API_Weather_Paula_Ordonez - Input City])&lt;&gt; &quot;&quot; OR Len([API_Weather_Paula_Ordonez - Input City])&gt;15" /><ontrue>01519bc4-a5ce-456a-98fc-ba8a415e9e34</ontrue><onfalse>16d13475-15ec-4942-83ef-50741dba9350</onfalse></stage><stage stageid="16d13475-15ec-4942-83ef-50741dba9350" name="BE" type="Exception"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="135" y="-30" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="Business Exception" detail="&quot;The input entered is not valid.&quot;" /></stage><stage stageid="a8159f32-db71-4a9e-b46f-765c4e17843c" name="Check Emial" type="Decision"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="15" y="210" w="90" h="60" /><decision expression="InStr([API_Weather_Paula_Ordonez - Input Email],&quot;@&quot;)&gt;0" /><ontrue>c3d6a310-7c96-4e8c-bff3-35673527eb7e</ontrue><onfalse>a57b44a1-aed5-4139-88e8-92b7d73ea9d1</onfalse></stage><stage stageid="a57b44a1-aed5-4139-88e8-92b7d73ea9d1" name="BE" type="Exception"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="135" y="210" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="&quot;The input entered is not valid.&quot;" /></stage><stage stageid="7182826f-5676-44f1-89b9-7984aad106c6" name="Initialization" type="SubSheetInfo"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="1a61e1bd-8fda-4567-b4c5-9225163ab054" name="Start" type="Start"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="15" y="-105" /><onsuccess>0afc0fd2-8759-4d40-96b9-0dd78713c301</onsuccess></stage><stage stageid="f4841927-006a-4a65-9746-895f78774362" name="End" type="End"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="15" y="510" /></stage><stage stageid="8c10d12c-5da2-4efe-8e1d-5b476199663f" name="Outlook Exist?" type="Decision"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="15" y="30" w="90" h="60" /><decision expression="[Exists]" /><ontrue>f4ed63b2-a2fd-4f86-9334-2b122df43c8a</ontrue><onfalse>01490f4e-2836-475e-8ffa-769137cfe8a4</onfalse></stage><stage stageid="7e2a3a2f-735b-4fe0-8227-624795663f22" name="Exists" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="-195" y="-15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="01490f4e-2836-475e-8ffa-769137cfe8a4" name="Start Process - Outlook" type="Action"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="165" y="30" /><inputs><input type="text" name="Application" friendlyname="Application" narrative="The application or short cut to start" expr="[Outlook Path]" /><input type="text" name="Arguments" friendlyname="Arguments" narrative="Any arguments needed for the app" expr="" /></inputs><onsuccess>bdbf862b-72b5-42d5-9afe-582eb7b93f72</onsuccess><resource object="Utility - Environment" action="Start Process" /></stage><stage stageid="bdbf862b-72b5-42d5-9afe-582eb7b93f72" name="Wait for Outlook" type="Action"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="165" y="90" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to attach to" expr="[Outlook Process Name]" /><input type="text" name="Window Title" friendlyname="Window Title" narrative="The title of the window within the process" expr="[Window Title ]" /><input type="number" name="Wait" friendlyname="Wait" narrative="The maximum amount of time to wait for" expr="[Wait]" /></inputs><outputs><output type="flag" name="Found" friendlyname="Found" stage="Found" /></outputs><onsuccess>7813d907-ffe9-4208-959a-a83097a1df95</onsuccess><resource object="Utility - Environment" action="Wait for Process Window" /></stage><stage stageid="7fcac022-7a75-43e3-a812-e934f626ac7e" name="Found" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="-195" y="15" w="120" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7813d907-ffe9-4208-959a-a83097a1df95" name="Outlook Window Exist?" type="Decision"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="165" y="165" w="60" h="60" /><decision expression="[Found]" /><ontrue>f4ed63b2-a2fd-4f86-9334-2b122df43c8a</ontrue><onfalse>a8dd9d8c-9367-4d44-9ae5-a0e7347f96c2</onfalse></stage><stage stageid="a8dd9d8c-9367-4d44-9ae5-a0e7347f96c2" name="Outlook Killed?" type="Decision"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="285" y="165" w="60" h="60" /><decision expression="[Outlook Killed?]" /><ontrue>022f57ca-77d7-4b48-89d8-f20d507dcdef</ontrue><onfalse>8be16960-5870-4847-a6df-b8f88a731dd6</onfalse></stage><stage stageid="6241f21b-8250-4d6f-af48-5c09c062feaa" name="Outlook Killed?" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="45" w="120" h="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="8be16960-5870-4847-a6df-b8f88a731dd6" name="Kill Outlook" type="Action"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="405" y="165" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="[Outlook Process Name]" /></inputs><onsuccess>979c0e0c-fc88-4987-a133-4158730c3920</onsuccess><resource object="Utility - Environment" action="Kill Process" /></stage><stage stageid="979c0e0c-fc88-4987-a133-4158730c3920" name="General Sleep" type="Action"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="405" y="90" /><inputs><input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="[Sleep]" /></inputs><onsuccess>baf7ed38-1fbc-49cb-a5a2-f5e5bccf4d05</onsuccess><resource object="Utility - General" action="Sleep" /></stage><stage stageid="baf7ed38-1fbc-49cb-a5a2-f5e5bccf4d05" name="Set Outlook Killed? to True" type="Calculation"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="405" y="30" /><onsuccess>01490f4e-2836-475e-8ffa-769137cfe8a4</onsuccess><calculation expression="True" stage="Outlook Killed?" /></stage><stage stageid="022f57ca-77d7-4b48-89d8-f20d507dcdef" name="SE" type="Exception"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><display x="285" y="240" w="90" h="30" /><exception localized="yes" type="System Exception" detail="&quot;Error with Outlook&quot;" /></stage><stage stageid="773f9e26-229f-4d74-9373-1e3db9f722a7" name="Window Title " type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="75" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">*Bandeja de entrada*</initialvalue><private /><alwaysinit /></stage><stage stageid="7ec6cb91-940c-4d5f-bf1a-74803b8fb0e8" name="Wait" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="165" w="120" h="30" /><datatype>number</datatype><initialvalue>30</initialvalue><private /><alwaysinit /></stage><stage stageid="e1eb866c-7ac2-450c-aaff-bfa1e394e37d" name="Sleep" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="195" w="120" h="30" /><datatype>number</datatype><initialvalue>2</initialvalue><private /><alwaysinit /></stage><stage stageid="4f3af43e-0814-4dd5-b3d4-cd23215b7a63" name="Outlook Path" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="135" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Outlook.lnk</initialvalue><private /><alwaysinit /></stage><stage stageid="14fc253d-43e0-4c4f-8d55-8e5449215b13" name="Outlook Process Name" type="Data"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="105" w="120" h="30" /><datatype>text</datatype><initialvalue xml:space="preserve">OUTLOOK</initialvalue><private /><alwaysinit /></stage><stage stageid="f4ed63b2-a2fd-4f86-9334-2b122df43c8a" name="Anchor2" type="Anchor"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" w="10" h="10" /><onsuccess>acd5e5f4-4612-4639-a726-ebaed4db833b</onsuccess></stage><stage stageid="57bf6ba1-2adb-4ef0-883a-3dbc3ded1e75" name="Block5" type="Block"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-45" w="150" h="270" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="0afc0fd2-8759-4d40-96b9-0dd78713c301" name="Outlook Exists" type="Action"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process" expr="&quot;OUTLOOK&quot;" /></inputs><outputs><output type="flag" name="Exists" friendlyname="Exists" narrative="True if the process exists" stage="Exists" /></outputs><onsuccess>8c10d12c-5da2-4efe-8e1d-5b476199663f</onsuccess><resource object="Utility - General" action="Process Exists" /></stage><stage stageid="acd5e5f4-4612-4639-a726-ebaed4db833b" name="Input Validation" type="SubSheet"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" w="90" h="60" /><onsuccess>f4841927-006a-4a65-9746-895f78774362</onsuccess><processid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</processid></stage><stage stageid="89b58eb7-c265-453e-b176-c1c0bfd4588b" name="Initialization" type="SubSheet"><loginhibit onsuccess="true" /><display x="75" y="0" w="90" h="60" /><onsuccess>cee88fe3-103b-4f0a-9c42-fb4484227f6e</onsuccess><processid>e140da8b-6041-4184-b819-a7f27ebb730f</processid></stage><stage stageid="e630229a-431a-4f2d-814e-4ecfcb2b2793" name="Load Queue" type="SubSheetInfo"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="3680aeb6-f221-4800-a947-6011cfaef0b4" name="Start" type="Start"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="15" y="-165" /><onsuccess>41cdb90d-2341-4914-8d63-b5bf6d16d8ac</onsuccess></stage><stage stageid="a9cf1e94-64fc-4c5d-9c73-bebf154ebd80" name="End" type="End"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="15" y="435" /></stage><stage stageid="0081ea13-2782-409c-88aa-26d0395f6d40" name="Input" type="Block"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-300" y="-45" w="210" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a7a7b1f2-71fa-45d5-ad23-7bfb57cda4f3" name="Input Collection" type="Collection"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="-195" y="0" w="180" h="60" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="City" type="text" /><field name="Country" type="text" /><field name="Email" type="text" /></collectioninfo><initialvalue><row><field name="City" type="text" value="" /><field name="Country" type="text" value="" /><field name="Email" type="text" value="" /></row></initialvalue></stage><stage stageid="e95634d1-67a5-4b35-8ab1-87ed7174378a" name="Files Loop" type="LoopStart"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" /><onsuccess>7b3f33ff-5eb0-44d1-aea7-20e4c6ed4d8f</onsuccess><groupid>b0e74b78-65e2-4786-a9d2-0be62774d648</groupid><looptype>ForEach</looptype><loopdata>Input Collection</loopdata></stage><stage stageid="3efbf15a-b41f-4224-a39c-b432f368eebc" name="Files Loop" type="LoopEnd"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="15" y="360" /><onsuccess>a9cf1e94-64fc-4c5d-9c73-bebf154ebd80</onsuccess><groupid>b0e74b78-65e2-4786-a9d2-0be62774d648</groupid></stage><stage stageid="7b3f33ff-5eb0-44d1-aea7-20e4c6ed4d8f" name="Create Quote Case" type="MultipleCalculation"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="15" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0f373597-421d-4a0d-b1a6-d0b14f8266db</onsuccess><steps><calculation expression="[Input Collection.City]" stage="Queue Item.City" /><calculation expression="[Input Collection.Country]" stage="Queue Item.Country" /><calculation expression="[Input Collection.Email]" stage="Queue Item.Email" /></steps></stage><stage stageid="df0440e4-90e3-40aa-8e19-164348a34471" name="Case Data to be added to queue" type="Block"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-300" y="60" w="210" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="b2fc1200-3afb-408e-853b-925b9de19fbe" name="Queue Item" type="Collection"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="105" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="City" type="text" /><field name="Email" type="text" /><field name="Country" type="text" /></collectioninfo><initialvalue><row><field name="City" type="text" value="" /><field name="Email" type="text" value="" /><field name="Country" type="text" value="" /></row></initialvalue></stage><stage stageid="0f373597-421d-4a0d-b1a6-d0b14f8266db" name="Is Item in queue already?" type="Action"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><narrative>Check if an item with the given key is already in the queue</narrative><display x="15" y="180" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue to check" expr="[Queue Name]" /><input type="text" name="Key" narrative="The key to check." expr="[Input Collection.Country]&amp;&quot; - &quot;&amp;FormatDateTime(Today(), &quot;dd.MM.yyyy&quot;)" /><input type="flag" name="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" /><input type="flag" name="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" /><input type="flag" name="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" /><input type="flag" name="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="True" /></inputs><outputs><output type="flag" name="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Result" /><output type="collection" name="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item IDs" /></outputs><onsuccess>7208106d-1b0b-474a-9432-db70a48aa3ae</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" /></stage><stage stageid="ca06cd2c-e17a-448d-b2f5-8bc9dacd6fa1" name="Item IDs" type="Collection"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="225" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><singlerow /><field name="Item ID" type="text" description="The Item ID of the work queue item" /></collectioninfo><initialvalue><singlerow /><row><field name="Item ID" type="text" value="" /></row></initialvalue></stage><stage stageid="0c32ea41-7bf7-411f-82ac-800fcacae9d7" name="ID of case added to queue" type="Block"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-300" y="180" w="210" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7208106d-1b0b-474a-9432-db70a48aa3ae" name="In Queue?" type="Decision"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="15" y="240" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Result]" /><ontrue>a1285984-0231-4df4-a752-56f8768b4028</ontrue><onfalse>6313dd2d-7b10-4c1f-9f56-996a6bd63531</onfalse></stage><stage stageid="6313dd2d-7b10-4c1f-9f56-996a6bd63531" name="Add to Queue" type="Action"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative><display x="15" y="300" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name]" /><input type="collection" name="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Queue Item]" /><input type="datetime" name="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" /><input type="number" name="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" /><input type="text" name="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="[Queue Item.City]" /><input type="text" name="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" /><input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr=""><validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" /></input></inputs><outputs><output type="collection" name="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="Item IDs" /></outputs><onsuccess>3efbf15a-b41f-4224-a39c-b432f368eebc</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" /></stage><stage stageid="c2d92b4a-bf22-4524-b55a-3c4618d44cd4" name="Result" type="Data"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><display x="105" y="240" w="90" h="30" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a1285984-0231-4df4-a752-56f8768b4028" name="Anchor2" type="Anchor"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="240" w="10" h="10" /><onsuccess>4899bbfe-ec9f-4459-9468-1c68abfb7de2</onsuccess></stage><stage stageid="4899bbfe-ec9f-4459-9468-1c68abfb7de2" name="Anchor3" type="Anchor"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="-60" y="360" w="10" h="10" /><onsuccess>3efbf15a-b41f-4224-a39c-b432f368eebc</onsuccess></stage><stage stageid="41cdb90d-2341-4914-8d63-b5bf6d16d8ac" name="Set Collection Field - City" type="Action"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" /><inputs><input type="number" name="Row Index" friendlyname="Row Index" narrative="The index of the row in which to set the value. The index is from 0 to N-1 (where N is the total number of rows in the collection)." expr="" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection in which to set the value." expr="[Input Collection]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the field in which to set the value" expr="&quot;City&quot;" /><input type="text" name="New Value" friendlyname="New Value" narrative="The value as text to set." expr="[API_Weather_Paula_Ordonez - Input City]" /></inputs><outputs><output type="collection" name="Updated Collection" friendlyname="Updated Collection" narrative="The collection which now has the value set." stage="Input Collection" /></outputs><onsuccess>cd0abc83-58c8-46a8-a815-edd358a747ef</onsuccess><resource object="Utility - Collection Manipulation" action="Set Collection Field" /></stage><stage stageid="cd0abc83-58c8-46a8-a815-edd358a747ef" name="Append Field - Country" type="Action"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Input Collection]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Country&quot;" /><input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[API_Weather_Paula_Ordonez - Input Country]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Input Collection" /></outputs><onsuccess>d1ca1510-ce10-4f45-a544-78cf8e48cd15</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Text)" /></stage><stage stageid="cee88fe3-103b-4f0a-9c42-fb4484227f6e" name="Load Queue" type="SubSheet"><loginhibit onsuccess="true" /><display x="75" y="90" w="90" h="60" /><onsuccess>4b3750b2-46c8-4169-bae7-064501151e22</onsuccess><processid>179011dc-6858-46c0-a4ca-bb59e3bce272</processid></stage><stage stageid="3e709a61-3357-4ce5-b900-aaf95ca9d4ad" name="Recover5" type="Recover"><loginhibit /><display x="165" y="45" /><onsuccess>b010dca8-d841-410f-a799-d930f860b8f3</onsuccess></stage><stage stageid="d169aa21-80bb-477b-afa9-76f65f29e7d2" name="Write to Log File" type="SubSheet"><loginhibit onsuccess="true" /><display x="480" y="45" w="90" h="60" /><onsuccess>d8640c58-3df9-415f-9355-3f9f4d44932f</onsuccess><processid>5a450492-3646-4305-b66c-24f04a043fdc</processid></stage><stage stageid="b010dca8-d841-410f-a799-d930f860b8f3" name="Exception Data" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="360" y="45" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d169aa21-80bb-477b-afa9-76f65f29e7d2</onsuccess><steps><calculation expression="ExceptionType()" stage="Exception Type" /><calculation expression="ExceptionDetail()" stage="Exception Detail" /></steps></stage><stage stageid="648a50df-0faf-400a-9e47-7388e489f3e7" name="Load" type="Block"><loginhibit onsuccess="true" /><display x="-45" y="-60" w="315" h="195" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="d8640c58-3df9-415f-9355-3f9f4d44932f" name="Resume2" type="Resume"><loginhibit /><display x="480" y="165" /><onsuccess>6d55daa9-2571-4345-a1b7-b45255dc8e6d</onsuccess></stage><stage stageid="4b3750b2-46c8-4169-bae7-064501151e22" name="Get Next Item" type="Action"><loginhibit onsuccess="true" /><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="75" y="240" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>a84e2220-63a6-418d-9833-1d3cc90b6c01</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="a84e2220-63a6-418d-9833-1d3cc90b6c01" name="Got Item?" type="Decision"><loginhibit onsuccess="true" /><display x="225" y="240" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Item ID]&lt;&gt;&quot;&quot;" /><ontrue>52ecbcf6-1a74-4fc6-9f08-831ec31b6605</ontrue><onfalse>6d55daa9-2571-4345-a1b7-b45255dc8e6d</onfalse></stage><stage stageid="1e877109-a6ef-4295-9192-b0e2cfac0a11" name="Search With API" type="SubSheetInfo"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="8c5bb566-852c-4cae-abb4-fa81c8f276e9" name="Start" type="Start"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="15" y="-105" /><inputs><input type="text" name="City" stage="City" /><input type="text" name="Country" stage="Country" /></inputs><onsuccess>dbfa4b88-e03e-4f70-8fd6-587dc039bd1c</onsuccess></stage><stage stageid="8d73abc4-debc-4daa-974a-fd55f70049ce" name="End" type="End"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="15" y="165" /><outputs><output type="collection" name="Result Collection" stage="Result Collections" /></outputs></stage><stage stageid="e4a4c397-c259-466d-82cf-bf3f7c7cfc2d" name="Search City" type="Action"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" w="120" h="30" /><inputs><input type="text" name="City" friendlyname="City" expr="[City]" /><input type="text" name="Country" friendlyname="Country" expr="[Country]" /></inputs><outputs><output type="collection" name="Result Collections" friendlyname="Result Collections" stage="Result Collections" /></outputs><onsuccess>f41917f3-8c96-4f37-b38e-0555ab65d8b1</onsuccess><resource object="API_Weather_Paula_Ordonez - Search" action="Get Weather" /></stage><stage stageid="d3acb47f-848e-42dd-ab1b-c2a9d03d73eb" name="Inputs" type="Block"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="-285" y="-45" w="180" h="90" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="062befe5-32e4-4f0a-bca2-a4c15a2aaf13" name="Recover" type="Recover"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="165" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a01efd2b-6d3e-4811-a065-c8d803c08f69</onsuccess></stage><stage stageid="6f9a650a-1453-4da8-8356-e51498d607d9" name="Resume1" type="Resume"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit /><display x="165" y="-60" /><onsuccess>dbfa4b88-e03e-4f70-8fd6-587dc039bd1c</onsuccess></stage><stage stageid="105b7b87-2864-485b-89e5-2070e3ee8906" name="Kill Chrome" type="Action"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="270" y="-60" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="&quot;chrome&quot;" /></inputs><onsuccess>6f9a650a-1453-4da8-8356-e51498d607d9</onsuccess><resource object="Utility - Environment" action="Kill Process" /></stage><stage stageid="4a5e0b2b-49fc-4c66-a0fd-b86e7f3628cb" name="Throw" type="Exception"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="495" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="a01efd2b-6d3e-4811-a065-c8d803c08f69" name="Retry?" type="Decision"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="360" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[API_Weather_Paula_Ordonez - Retry Limit]AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>a164b7f4-e1de-4224-9131-5e89535a17ec</ontrue><onfalse>4a5e0b2b-49fc-4c66-a0fd-b86e7f3628cb</onfalse></stage><stage stageid="a164b7f4-e1de-4224-9131-5e89535a17ec" name="Count" type="Calculation"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="360" y="-60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>105b7b87-2864-485b-89e5-2070e3ee8906</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="dbfa4b88-e03e-4f70-8fd6-587dc039bd1c" name="Anchor4" type="Anchor"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-60" w="10" h="10" /><onsuccess>e4a4c397-c259-466d-82cf-bf3f7c7cfc2d</onsuccess></stage><stage stageid="95f7169b-2a4a-4d5a-96d7-7d2eb7ececa9" name="City" type="Data"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="-195" y="-15" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6dc2722b-879d-4717-986a-ce24237562b7" name="Search" type="Block"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="-75" y="-15" w="300" h="75" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="52ecbcf6-1a74-4fc6-9f08-831ec31b6605" name="Search With API" type="SubSheet"><loginhibit onsuccess="true" /><display x="225" y="360" w="90" h="60" /><inputs><input type="text" name="City" friendlyname="City" expr="[Item Data.City]" /><input type="text" name="Country" friendlyname="Country" expr="[Item Data.Country]" /></inputs><outputs><output type="collection" name="Result Collection" friendlyname="Result Collection" stage="Weather Result Collection" /></outputs><onsuccess>12c3f3a3-4e95-4287-9b8a-5755d4aa7684</onsuccess><processid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</processid></stage><stage stageid="e3b0ff4f-38c1-46c2-b511-1b89e527ae97" name="Global Variables" type="Block"><loginhibit onsuccess="true" /><display x="-510" y="45" w="180" h="120" /><font family="Segoe UI" size="10" style="Regular" color="00FFFF" /></stage><stage stageid="527b1d54-deb5-4743-9bbc-959b6cc61726" name="Retry Count" type="Data"><loginhibit onsuccess="true" /><display x="-420" y="135" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><alwaysinit /></stage><stage stageid="01181a15-8f7f-478d-bffb-e4fae33d4baa" name="Weather Result Collection" type="Collection"><loginhibit onsuccess="true" /><display x="-420" y="90" w="180" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="f41917f3-8c96-4f37-b38e-0555ab65d8b1" name="Reset Count" type="Calculation"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="15" y="105" /><onsuccess>8d73abc4-debc-4daa-974a-fd55f70049ce</onsuccess><calculation expression="0" stage="Retry Count" /></stage><stage stageid="c8dd261e-0c32-4a69-994c-a96e1ef8549d" name="Results Outputs" type="Block"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><loginhibit onsuccess="true" /><display x="-285" y="60" w="180" h="90" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1d9efb60-475c-423e-9b33-b7025984ef1a" name="Recover" type="Recover"><loginhibit onsuccess="true" /><display x="225" y="435" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>7e9ef5f0-cd73-4eca-a824-5848279cfdf3</onsuccess></stage><stage stageid="7e9ef5f0-cd73-4eca-a824-5848279cfdf3" name="Exception Data" type="MultipleCalculation"><loginhibit onsuccess="true" /><display x="225" y="555" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>414d4898-28a7-4faa-8061-a026fddb33ee</onsuccess><steps><calculation expression="ExceptionType()" stage="Exception Type" /><calculation expression="ExceptionDetail()" stage="Exception Detail" /></steps></stage><stage stageid="414d4898-28a7-4faa-8061-a026fddb33ee" name="Mark Item As Exception" type="SubSheet"><loginhibit onsuccess="true" /><display x="345" y="555" w="90" h="60" /><onsuccess>31cded15-5c4a-428d-a0b4-8f8bf89a41ca</onsuccess><processid>dc85990b-873b-41f5-a890-4235c82a6945</processid></stage><stage stageid="31cded15-5c4a-428d-a0b4-8f8bf89a41ca" name="Resume" type="Resume"><loginhibit onsuccess="true" /><display x="525" y="555" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c578e074-902f-4185-a3dd-57b6c0aba240</onsuccess></stage><stage stageid="c578e074-902f-4185-a3dd-57b6c0aba240" name="Write to Log File" type="SubSheet"><loginhibit onsuccess="true" /><display x="825" y="555" w="90" h="60" /><onsuccess>12c3f3a3-4e95-4287-9b8a-5755d4aa7684</onsuccess><processid>5a450492-3646-4305-b66c-24f04a043fdc</processid></stage><stage stageid="5ca547af-7094-4245-9357-bf193b38c884" name="Work" type="Block"><loginhibit onsuccess="true" /><display x="120" y="315" w="210" h="150" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="12c3f3a3-4e95-4287-9b8a-5755d4aa7684" name="Mark Item As Completed" type="SubSheet"><display x="825" y="360" w="90" h="60" /><onsuccess>0acdfed1-c5dd-4617-a133-9619a01bee6b</onsuccess><processid>bf8c38d5-ec20-41f8-ba86-08f891a34c27</processid></stage><stage stageid="0acdfed1-c5dd-4617-a133-9619a01bee6b" name="Reset Global Data" type="SubSheet"><display x="825" y="240" w="90" h="60" /><onsuccess>22612b1b-478c-4f41-8ab1-8577817fee43</onsuccess><processid>17f50615-0daf-4f08-b6b0-93027451ea25</processid></stage><stage stageid="126aa2b5-efe2-467c-81b8-eda9c7fdc8ad" name="Get Next Item" type="Action"><loginhibit onsuccess="true" /><narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative><display x="510" y="240" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" /><input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" /><input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" /></inputs><outputs><output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" /><output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" /><output type="text" name="Status" narrative="The status of the item." stage="Item Status" /><output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Item Attempts" /></outputs><onsuccess>a84e2220-63a6-418d-9833-1d3cc90b6c01</onsuccess><resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" /></stage><stage stageid="1763af2a-59b5-45ae-be0e-314b60180417" name="Result Collections" type="Collection"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="-195" y="105" w="180" h="60" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c3d7d02c-2e35-46c5-8af2-25ad64903bda" name="API_Weather_Paula_Ordonez - Input Country" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="120" w="210" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="29311fd5-0e72-4d23-a874-0139b9580d87" name="Country" type="Data"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><display x="-195" y="15" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="01519bc4-a5ce-456a-98fc-ba8a415e9e34" name="Check Country" type="Decision"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="15" y="90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Trim([API_Weather_Paula_Ordonez - Input Country])&lt;&gt; &quot;&quot; OR Len([API_Weather_Paula_Ordonez - Input Country])&gt;15" /><ontrue>a8159f32-db71-4a9e-b46f-765c4e17843c</ontrue><onfalse>be432814-c654-4b42-8dcd-9b5e4773c88a</onfalse></stage><stage stageid="be432814-c654-4b42-8dcd-9b5e4773c88a" name="BE" type="Exception"><subsheetid>a074a96f-75b8-4a58-9db9-b5f33cb1355d</subsheetid><display x="135" y="90" w="90" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="Business Exception" detail="&quot;The input entered is not valid.&quot;" /></stage><stage stageid="d1ca1510-ce10-4f45-a544-78cf8e48cd15" name="Append Field - Country" type="Action"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><loginhibit onsuccess="true" /><display x="15" y="0" /><inputs><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Input Collection]" /><input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Email&quot;" /><input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="[Input Collection.Email]" /></inputs><outputs><output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Input Collection" /></outputs><onsuccess>e95634d1-67a5-4b35-8ab1-87ed7174378a</onsuccess><resource object="Utility - Collection Manipulation" action="Append Field (Text)" /></stage><stage stageid="ef750c55-5748-479d-85c7-08bab06b0e99" name="Send Mail" type="SubSheetInfo"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><display x="-240" y="-75" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4849d805-1449-4c22-afb1-0fa8bc27b3b6" name="Start" type="Start"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit /><display x="15" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>754dac0e-f24a-4877-9cc9-ec6ca54e484c</onsuccess></stage><stage stageid="c7c2e80d-7cbe-43d7-b771-8bc698dc1f50" name="Step 3a Block" type="Block"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit /><display x="-60" y="15" w="255" h="120" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="754dac0e-f24a-4877-9cc9-ec6ca54e484c" name="anchor5" type="Anchor"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><display x="15" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>cdeb1850-eb83-4803-9edf-4a3ded8ba983</onsuccess></stage><stage stageid="d9a341bc-6506-4a7c-8504-0b853b1653b9" name="End8" type="End"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="15" y="240" /></stage><stage stageid="cdeb1850-eb83-4803-9edf-4a3ded8ba983" name="Send Email" type="Action"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" w="120" h="30" /><inputs><input type="text" name="To" friendlyname="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[API_Weather_Paula_Ordonez - Input Email]" /><input type="text" name="CC" friendlyname="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="" /><input type="text" name="BCC" friendlyname="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="" /><input type="text" name="Subject" friendlyname="Subject" narrative="Optional. Any alphanumeric value allowed." expr="&quot;Weather Results&quot;" /><input type="text" name="Message" friendlyname="Message" narrative="Optional, HTML or plain text" expr="&quot;Here is the latest weather result.&quot;&amp;Today()" /><input type="text" name="Attachments" friendlyname="Attachments" narrative="Optional, Semicolon--separated file paths. Default blank." expr="[File Path]" /><input type="flag" name="IsHTML" friendlyname="IsHTML" narrative="Optional. True or False, default to True" expr="False" /><input type="number" name="Sensitivity" friendlyname="Sensitivity" narrative="Optional. An integer between 0 and 3, default to 0." expr="" /><input type="number" name="Importance" friendlyname="Importance" narrative="Optional. An integer between 0 and 2 default to 1." expr="" /><input type="text" name="Account Display Name" friendlyname="Account Display Name" narrative="Optional. DisplayName of the email account. Default account is used if omitted." expr="" /></inputs><onsuccess>bb1ea186-a5dd-436a-aa58-1f7f6f513c64</onsuccess><resource object="MS Outlook Email VBO" action="Send Email" /></stage><stage stageid="bb1ea186-a5dd-436a-aa58-1f7f6f513c64" name="Reset Retry Count" type="Calculation"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" /><onsuccess>d9a341bc-6506-4a7c-8504-0b853b1653b9</onsuccess><calculation expression="0" stage="Retry Count" /></stage><stage stageid="9ed8a398-3a4d-4013-a6f5-5384c7038792" name="Recover" type="Recover"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="135" y="75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0761bb28-3e9f-4466-87bc-7860a8b8bd03</onsuccess></stage><stage stageid="64a0ecd1-7a3f-40e1-85f8-d67549e7fee6" name="Resume1" type="Resume"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit /><display x="135" y="-45" /><onsuccess>754dac0e-f24a-4877-9cc9-ec6ca54e484c</onsuccess></stage><stage stageid="be6632f3-eea3-43cc-8233-0aecf8f029a4" name="Kill Chrome" type="Action"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="240" y="-45" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="&quot;OUTLOOK&quot;" /></inputs><onsuccess>64a0ecd1-7a3f-40e1-85f8-d67549e7fee6</onsuccess><resource object="Utility - Environment" action="Kill Process" /></stage><stage stageid="6955cace-92c8-429b-b85e-2d9b76392bdd" name="Throw" type="Exception"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="465" y="75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="0761bb28-3e9f-4466-87bc-7860a8b8bd03" name="Retry?" type="Decision"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="330" y="75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Retry Count]&lt;[API_Weather_Paula_Ordonez - Retry Limit]AND (Lower(ExceptionType())=&quot;system exception&quot; OR Lower(ExceptionType())=&quot;internal&quot;)" /><ontrue>8467ed80-ab35-45b8-b130-d7db913040a6</ontrue><onfalse>6955cace-92c8-429b-b85e-2d9b76392bdd</onfalse></stage><stage stageid="8467ed80-ab35-45b8-b130-d7db913040a6" name="Count" type="Calculation"><subsheetid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</subsheetid><loginhibit onsuccess="true" /><display x="330" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>be6632f3-eea3-43cc-8233-0aecf8f029a4</onsuccess><calculation expression="[Retry Count]+1" stage="Retry Count" /></stage><stage stageid="345f1359-0e7e-475e-b169-4c053510e363" name="Write Results &amp; Send Email" type="SubSheetInfo"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="19cdaaca-4589-4811-af1f-5092ad038f77" name="Start" type="Start"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="15" y="-150" /><onsuccess>5cb0fd22-f4c0-46db-9ebc-cd89dd3164eb</onsuccess></stage><stage stageid="8f1c4c2d-6665-42ad-a03e-56f1492b72f2" name="End" type="End"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="15" y="540" /></stage><stage stageid="22612b1b-478c-4f41-8ab1-8577817fee43" name="Write Results &amp; Send Email" type="SubSheet"><loginhibit onsuccess="true" /><display x="675" y="240" w="90" h="60" /><onsuccess>126aa2b5-efe2-467c-81b8-eda9c7fdc8ad</onsuccess><processid>bbfd9f07-994b-4939-8c7b-4c87152e4356</processid></stage><stage stageid="5cb0fd22-f4c0-46db-9ebc-cd89dd3164eb" name="Kill Excel" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-105" /><inputs><input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="&quot;EXCEL&quot;" /></inputs><onsuccess>964e3878-8755-4889-8d9b-3deb9d7f7be1</onsuccess><resource object="Utility - Environment" action="Kill Process" /></stage><stage stageid="964e3878-8755-4889-8d9b-3deb9d7f7be1" name="Create File Path" type="Calculation"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-45" /><onsuccess>c2af0ab0-d8ed-4bd0-9db8-6ffbe624641a</onsuccess><calculation expression="[API_Weather_Paula_Ordonez - Output File]&amp;&quot;Result Weather.xlsx&quot;" stage="File Path" /></stage><stage stageid="a4a3a926-596b-4be6-88e7-f2235b688770" name="handle" type="Data"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="-195" y="0" w="120" h="30" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="984a3dd8-ac30-44d8-b149-d5e57348cc68" name="Workbook Name" type="Data"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="-195" y="30" w="120" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3f18e49f-43e6-459d-8fab-ac737f67518c" name="Variables" type="Block"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="-270" y="-30" w="150" h="150" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="dbd6aca1-d5db-4df1-8aca-26f7c8800c06" name="File Path" type="Data"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="-195" y="60" w="120" h="30" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="6a05a686-e2cc-4d82-bdbd-c89bc8316ee8" name="API_Weather_Paula_Ordonez - Output File" type="Data"><loginhibit onsuccess="true" /><display x="-210" y="240" w="210" h="30" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><alwaysinit /></stage><stage stageid="c2af0ab0-d8ed-4bd0-9db8-6ffbe624641a" name="Create Instance" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="0" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>340080a5-ccc7-41ba-a823-d3b68ea9477b</onsuccess><resource object="MS Excel VBO - Extended" action="Create Instance" /></stage><stage stageid="617ea879-321d-4732-98a2-e38d5c6b1daf" name="Write Collection" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="120" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" /><input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="" /><input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Weather Result Collection]" /><input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" /><input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" /></inputs><onsuccess>64af9d39-5e7d-42e1-be3b-cd84f419badc</onsuccess><resource object="MS Excel VBO - Extended" action="Write Collection" /></stage><stage stageid="3ee8bb5f-e946-4ca7-9c75-d1be3ede3517" name="Empty Collection" type="Collection"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><display x="-195" y="90" w="120" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="187622f7-d784-4899-9b67-d24d748571b0" name="Reset Completed Result Collection" type="Calculation"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="255" /><onsuccess>2d579049-bce8-4c1f-bd90-6e6ceebaef05</onsuccess><calculation expression="[Empty Collection]" stage="Weather Result Collection" /></stage><stage stageid="3a553c46-e387-4776-9e6d-f000739868a1" name="Close Instance" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="390" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" /><input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="True" /></inputs><onsuccess>3c91e978-c600-4d72-968c-5b2bc7794e11</onsuccess><resource object="MS Excel VBO - Extended" action="Close Instance" /></stage><stage stageid="2d579049-bce8-4c1f-bd90-6e6ceebaef05" name="Close Workbook" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="330" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook which should be closed resides. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which should be closed." expr="[Workbook Name]" /><input type="flag" name="Save Data" friendlyname="Save Data" narrative="True to save the data before closing the workbook; The default of False will discard any changes before closing the workbook." expr="True" /></inputs><onsuccess>3a553c46-e387-4776-9e6d-f000739868a1</onsuccess><resource object="MS Excel VBO - Extended" action="Close Workbook" /></stage><stage stageid="340080a5-ccc7-41ba-a823-d3b68ea9477b" name="Create Workbook" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name" /></outputs><onsuccess>617ea879-321d-4732-98a2-e38d5c6b1daf</onsuccess><resource object="MS Excel VBO - Extended" action="Create Workbook" /></stage><stage stageid="64af9d39-5e7d-42e1-be3b-cd84f419badc" name="Save Current Workbook As" type="Action"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="195" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance for which the current workbook which should be saved. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The full path and file name to which the current workbook should be saved." expr="[File Path]" /></inputs><outputs><output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook." stage="Workbook Name" /></outputs><onsuccess>187622f7-d784-4899-9b67-d24d748571b0</onsuccess><resource object="MS Excel VBO - Extended" action="Save Current Workbook As" /></stage><stage stageid="3c91e978-c600-4d72-968c-5b2bc7794e11" name="Send Mail" type="SubSheet"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><loginhibit onsuccess="true" /><display x="15" y="465" w="90" h="60" /><onsuccess>8f1c4c2d-6665-42ad-a03e-56f1492b72f2</onsuccess><processid>cd9e6bbd-aec8-4903-8dcc-3c61212b36ea</processid></stage><stage stageid="027363c8-7a0b-4f72-9d19-3fc820fcc817" name="Recover1" type="Recover"><loginhibit /><display x="675" y="135" /><onsuccess>ead11bf7-e310-4328-8acc-ba5def9bf5ac</onsuccess></stage><stage stageid="c3a74d81-59cd-4aed-9452-e7272c22f3b0" name="Write &amp; Send" type="Block"><loginhibit onsuccess="true" /><display x="615" y="105" w="135" h="180" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ead11bf7-e310-4328-8acc-ba5def9bf5ac" name="Anchor1" type="Anchor"><loginhibit onsuccess="true" /><display x="675" y="-30" w="10" h="10" /><onsuccess>69b8f93e-0937-496d-a306-8a575675503c</onsuccess></stage><stage stageid="69b8f93e-0937-496d-a306-8a575675503c" name="Anchor5" type="Anchor"><loginhibit onsuccess="true" /><display x="360" y="-30" w="10" h="10" /><onsuccess>b010dca8-d841-410f-a799-d930f860b8f3</onsuccess></stage><stage stageid="dc0838a7-e81b-4037-aaea-0294d26bf23e" name="Note1" type="Note"><narrative>To access the description of each stage, simply find it inside each stage.</narrative><display x="420" y="-165" w="480" h="60" /><font family="Segoe UI" size="17" style="Bold" color="0000FF" /></stage><stage stageid="ee5a88cd-c6aa-4ed0-8575-a36eabcbeb61" name="Note1" type="Note"><subsheetid>e140da8b-6041-4184-b819-a7f27ebb730f</subsheetid><narrative>1. In the Initialization stage, we ensure that Outlook is closed and validate the input parameters to ensure there are no exceptions.</narrative><display x="390" y="-105" w="480" h="60" /><font family="Segoe UI" size="17" style="Bold" color="0000FF" /></stage><stage stageid="2e2493ac-9bc8-44f3-a458-166f755baa71" name="Note1" type="Note"><subsheetid>179011dc-6858-46c0-a4ca-bb59e3bce272</subsheetid><narrative>2. Load Queue: We load our inputs into our queue to start working with them in the Weather API.</narrative><display x="240" y="-75" w="240" h="150" /><font family="Segoe UI" size="17" style="Bold" color="0000FF" /></stage><stage stageid="2199f0f0-3bde-4c07-86ba-4f635461ac54" name="Note1" type="Note"><subsheetid>a203acf2-4a8d-4249-bc98-0ff7ef117e52</subsheetid><narrative>3. In the Search with API stage, this phase is the main task. To build this Web Service, it's necessary to have a base URL, in this case: https://api.weatherbit.io. To configure our Web Service in BP, we go to Systems, create a new Web Service, attach the base URL, and depending on what we want to search in our current weather, we can include in our new URL the country, postal code, and country, and our key is mandatory. We simply add them to our parameters within the configuration. Once created, we can use it in our object to capture the current weather, but in JSON. We will use another action to convert from JSON to a collection, and the information will be saved in a global collection.</narrative><display x="300" y="-240" w="420" h="240" /><font family="Segoe UI" size="17" style="Bold" color="0000FF" /></stage><stage stageid="10c48dbc-f520-4f58-9bb7-c6c44066eb7d" name="Note1" type="Note"><subsheetid>bbfd9f07-994b-4939-8c7b-4c87152e4356</subsheetid><narrative>4. Write Results &amp; Send Email: This final stage is responsible for writing the information captured by our API into an Excel file. This information will be sent via email to the recipient who requested it.</narrative><display x="300" y="-15" w="330" h="150" /><font family="Segoe UI" size="17" style="Bold" color="0000FF" /></stage></process></process>
        <object id="cc2a9432-8a89-4f5b-9fca-b1a586286876" name="API_Weather_Paula_Ordonez - Search" xmlns="http://www.blueprism.co.uk/product/process"><process name="API_Weather_Paula_Ordonez - Search" version="1.0" bpversion="7.2.1.7446" narrative="" byrefcollection="true" processrunningmessage="" disableversioning="false" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>0b4d95dd-b01f-4690-a7a7-d075cc32a57f</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="d9db72ee-3055-4e62-9839-b9a7f8986aa6" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="64bc0b01-a2e4-47f9-b16b-17d92b104656" type="Normal" published="True"><name>Get Weather</name><view><camerax>-100</camerax><cameray>67</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="0a76c4b8-f532-4f78-ad7f-06acb3b6d346" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>2fd19ca4-a8f8-47f8-9fb4-01be97565610</onsuccess></stage><stage stageid="2fd19ca4-a8f8-47f8-9fb4-01be97565610" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="1c3eaad5-258d-4c7c-8387-f59130b8f97a" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="fc86bb24-efd6-4546-a543-b74c637bad2e" name="Clean Up" type="SubSheetInfo"><subsheetid>d9db72ee-3055-4e62-9839-b9a7f8986aa6</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="b9890c38-5d90-4188-8d69-c0a576f41500" name="Start" type="Start"><subsheetid>d9db72ee-3055-4e62-9839-b9a7f8986aa6</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>3229b3e0-9e09-44a1-8e14-e592d519608d</onsuccess></stage><stage stageid="3229b3e0-9e09-44a1-8e14-e592d519608d" name="End" type="End"><subsheetid>d9db72ee-3055-4e62-9839-b9a7f8986aa6</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="d7244d65-98f8-4b3c-b86b-e191cde97159" name="Get Weather" type="SubSheetInfo"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="d6a108b9-fe00-4bdc-9fe1-a1abbcf30c3b" name="Start" type="Start"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="City" stage="City Name" /><input type="text" name="Country" stage="Country Name" /></inputs><onsuccess>99d5879f-266c-4af4-b8f8-9e868a32309e</onsuccess></stage><stage stageid="e6a8b2ce-8fb8-427e-999e-88145f6824d6" name="End" type="End"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="15" y="225" /><outputs><output type="collection" name="Result Collections" stage="Result Collection Weather" /></outputs></stage><stage stageid="97f2893f-6d2d-4135-9a15-296026256b88" name="" type="Note"><subsheetid>d9db72ee-3055-4e62-9839-b9a7f8986aa6</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="fb3e1445-e4fe-4f6a-b181-6dd1ea4816df" name="" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="99d5879f-266c-4af4-b8f8-9e868a32309e" name="Get Current Weather" type="Action"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" /><inputs><input type="text" name="city_name" friendlyname="city_name" expr="[City Name]" /><input type="text" name="country_name" friendlyname="country_name" expr="[Country Name]" /></inputs><outputs><output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" /><output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" /><output type="collection" name="Response Headers" friendlyname="Response Headers" stage="Response Headers" /></outputs><onsuccess>fb3078c2-6c79-4431-bb9d-7e11b5644afb</onsuccess><resource object="Open Weather Map API" action="Get Current Weather" /></stage><stage stageid="b543e5c0-4e68-427e-8d30-2b9d4db2b6e9" name="City Name" type="Data"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="-195" y="15" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2fd8aacd-6809-4c49-abf4-4fff1337e945" name="Response Content" type="Data"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="120" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="304b0f02-a46a-4743-b734-9468ff9436de" name="HTTP Status Code" type="Data"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="90" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73d0d6b5-abde-4687-8d78-5809f5b137e4" name="Response Headers" type="Collection"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="150" w="180" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7cf14e11-973b-441f-baa6-449bf6af340c" name="Output" type="Block"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="-285" y="60" w="180" h="180" /><font family="Segoe UI" size="10" style="Regular" color="CC99FF" /></stage><stage stageid="ea8bcd15-c05b-46b9-85fe-943e13e39b64" name="Input" type="Block"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="-285" y="-45" w="180" h="90" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="88046663-8473-4723-8d4f-28eeafa2c51e" name="Result Collection" type="Collection"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="180" w="180" h="30" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="fb3078c2-6c79-4431-bb9d-7e11b5644afb" name="JSON to Collection (Skipping Array)" type="Action"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit onsuccess="true" /><display x="15" y="60" /><inputs><input type="text" name="json" friendlyname="json" expr="[Response Content]" /></inputs><outputs><output type="collection" name="Result" friendlyname="Result" stage="Result Collection" /></outputs><onsuccess>5fce9bad-1d44-48a3-8851-5fb4874e940c</onsuccess><resource object="Utility - JSON" action="JSON to Collection (skipping JArray)" /></stage><stage stageid="d8b3093e-edf7-4ad1-979d-3fd1a58b0810" name="Result Collection Weather" type="Collection"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="210" w="180" h="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Temp" type="number" /><field name="City" type="text" /><field name="Country Code" type="text" /><field name="Description" type="text" /><field name="Latitude" type="number" /><field name="Longitude" type="number" /><field name="Object Time" type="text" /><field name="Precipitation" type="number" /><field name="Clouds" type="number" /><field name="Sunrise" type="text" /><field name="Suset" type="text" /><field name="TimeZone" type="text" /></collectioninfo><initialvalue><row><field name="Temp" type="number" value="" /><field name="City" type="text" value="" /><field name="Country Code" type="text" value="" /><field name="Description" type="text" value="" /><field name="Latitude" type="number" value="" /><field name="Longitude" type="number" value="" /><field name="Object Time" type="text" value="" /><field name="Precipitation" type="number" value="" /><field name="Clouds" type="number" value="" /><field name="Sunrise" type="text" value="" /><field name="Suset" type="text" value="" /><field name="TimeZone" type="text" value="" /></row></initialvalue></stage><stage stageid="5fce9bad-1d44-48a3-8851-5fb4874e940c" name="Multi1" type="MultipleCalculation"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="15" y="150" /><onsuccess>e6a8b2ce-8fb8-427e-999e-88145f6824d6</onsuccess><steps><calculation expression="[Result Collection.data.city_name] " stage="Result Collection Weather.City" /><calculation expression="[Result Collection.data.country_code]" stage="Result Collection Weather.Country Code" /><calculation expression="[Result Collection.data.temp]" stage="Result Collection Weather.Temp" /><calculation expression="[Result Collection.data.weather.description] " stage="Result Collection Weather.Description" /><calculation expression="[Result Collection.data.lat]" stage="Result Collection Weather.Latitude" /><calculation expression="[Result Collection.data.lon]" stage="Result Collection Weather.Longitude" /><calculation expression="[Result Collection.data.ob_time]" stage="Result Collection Weather.Object Time" /><calculation expression="[Result Collection.data.precip]" stage="Result Collection Weather.Precipitation" /><calculation expression="[Result Collection.data.clouds]" stage="Result Collection Weather.Clouds" /><calculation expression="[Result Collection.data.sunrise]" stage="Result Collection Weather.Sunrise" /><calculation expression="[Result Collection.data.sunset]" stage="Result Collection Weather.Suset" /><calculation expression="[Result Collection.data.timezone]" stage="Result Collection Weather.TimeZone" /></steps></stage><stage stageid="2c158258-ca05-4f5a-a763-0d0c88880fd8" name="Country Name" type="Data"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="-195" y="-15" w="180" h="30" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ef589daa-7050-4fa5-84a8-51cf8fbaa5ff" name="Recover1" type="Recover"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="105" y="-15" /><onsuccess>8708a2aa-4a6f-46b3-9c3a-66222fd2c6b2</onsuccess></stage><stage stageid="8708a2aa-4a6f-46b3-9c3a-66222fd2c6b2" name="SE" type="Exception"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><display x="240" y="-15" /><exception localized="yes" type="System Exception" detail="&quot;Invalid Parameters supplied.&quot;" /></stage><stage stageid="4e351a52-263e-4390-8b6f-33919d7f597e" name="Block1" type="Block"><subsheetid>64bc0b01-a2e4-47f9-b16b-17d92b104656</subsheetid><loginhibit /><display x="-45" y="-45" w="210" h="150" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage></process></object>
        <work-queue id="21" name="API_Weather_Paula_Ordonez - Queue" key-field="Country" xmlns="http://www.blueprism.co.uk/product/work-queue" />
        <environment-variable id="API_Weather_Paula_Ordonez - Files Error Path" name="API_Weather_Paula_Ordonez - Files Error Path" type="text" value="C:\Users\Administrator\OneDrive - School of Automation\Blue Prism Advance SOA\API_Weather_Paula_Ordonez\ErrorMessage.txt" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <environment-variable id="API_Weather_Paula_Ordonez - Input City" name="API_Weather_Paula_Ordonez - Input City" type="text" value="Madrid" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <environment-variable id="API_Weather_Paula_Ordonez - Input Country" name="API_Weather_Paula_Ordonez - Input Country" type="text" value="Spain" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <environment-variable id="API_Weather_Paula_Ordonez - Input Email" name="API_Weather_Paula_Ordonez - Input Email" type="text" value="paulamadrid93@gmail.com" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <environment-variable id="API_Weather_Paula_Ordonez - Output File" name="API_Weather_Paula_Ordonez - Output File" type="text" value="C:\Users\Administrator\OneDrive - School of Automation\Blue Prism Advance SOA\API_Weather_Paula_Ordonez\" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <environment-variable id="API_Weather_Paula_Ordonez - Retry Limit" name="API_Weather_Paula_Ordonez - Retry Limit" type="number" value="3" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>API</description>
        </environment-variable>
        <process-group id="c9cb93a8-b049-4df1-b57e-448e3010c41e" name="API_Weather_Paula_Ordonez - Process" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="3cb4dc9e-7fea-47f3-8536-2c54fa266335" />
            </members>
        </process-group>
        <object-group id="a17d11b7-98a2-4fa1-b193-c795b6644c89" name="API_Weather_Paula_Ordonez" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="cc2a9432-8a89-4f5b-9fca-b1a586286876" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>